# ğŸŒ ì›ê²© ë¸Œë¼ìš°ì € ì„œë²„ë¥¼ í†µí•œ Playwright í…ŒìŠ¤íŠ¸ ê³„íš

## ğŸ“‹ ê°œìš”
Firebase/Nix í™˜ê²½ì˜ ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì œì•½ì„ ìš°íšŒí•˜ê¸° ìœ„í•´ ì™¸ë¶€ ë¸Œë¼ìš°ì € ì„œë²„ë¥¼ í™œìš©

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì„¤ê³„

### 1. **ì›ê²© ë¸Œë¼ìš°ì € ì„œë²„ (ë³„ë„ ì¸ìŠ¤í„´ìŠ¤)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ì›ê²© ë¸Œë¼ìš°ì € ì„œë²„                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Docker Container                â”‚ â”‚
â”‚  â”‚ - Ubuntu 20.04/22.04           â”‚ â”‚
â”‚  â”‚ - Playwright + Chromium        â”‚ â”‚
â”‚  â”‚ - ëª¨ë“  ì‹œìŠ¤í…œ ì˜ì¡´ì„± ì„¤ì¹˜       â”‚ â”‚
â”‚  â”‚ - WebSocket/HTTP API ì„œë²„       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          í¬íŠ¸: 9222 (DevTools)      â”‚
â”‚          í¬íŠ¸: 8090 (API Server)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. **Firebase ìŠ¤íŠœë””ì˜¤ (í˜„ì¬ í™˜ê²½)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Firebase Studio (Nix)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Playwright Test Runner          â”‚ â”‚
â”‚  â”‚ - ì›ê²© ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸      â”‚ â”‚
â”‚  â”‚ - Test Auto-Repair Loop         â”‚ â”‚
â”‚  â”‚ - WindWalker Code Server        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚     â†•ï¸ WebSocket/HTTP í†µì‹           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ êµ¬í˜„ ê³„íš

### Phase 1: ì›ê²© ë¸Œë¼ìš°ì € ì„œë²„ êµ¬ì¶•
```bash
# Docker ê¸°ë°˜ ë¸Œë¼ìš°ì € ì„œë²„
FROM mcr.microsoft.com/playwright:v1.40.0-ubuntu20.04

WORKDIR /app
COPY package*.json ./
RUN npm install

# ë¸Œë¼ìš°ì € ì›ê²© ì ‘ì† API ì„œë²„ 
COPY remote-browser-server.js ./
EXPOSE 8090 9222

CMD ["node", "remote-browser-server.js"]
```

### Phase 2: ì›ê²© ë¸Œë¼ìš°ì € í´ë¼ì´ì–¸íŠ¸ ê°œë°œ
```javascript
// remote-browser-client.js
class RemoteBrowserClient {
  constructor(serverUrl) {
    this.serverUrl = serverUrl;
    this.wsConnection = null;
  }

  async connect() {
    // WebSocket ì—°ê²° ì„¤ì •
    this.wsConnection = new WebSocket(`${this.serverUrl}/ws`);
    
    // CDP (Chrome DevTools Protocol) í”„ë¡ì‹œ ì„¤ì •
    return this.setupCDPProxy();
  }

  async runTest(testCode) {
    // ì›ê²©ì—ì„œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    return await this.sendCommand('runTest', { code: testCode });
  }
}
```

### Phase 3: Playwright ì„¤ì • ìˆ˜ì •
```javascript
// playwright.config.js ì›ê²© ë¸Œë¼ìš°ì € ì„¤ì •
module.exports = defineConfig({
  use: {
    // ì›ê²© ë¸Œë¼ìš°ì € ì—°ê²°
    connect: {
      wsEndpoint: 'ws://remote-browser-server:8090/browser'
    }
  },
  
  projects: [
    {
      name: 'remote-chromium',
      use: { 
        browserName: 'chromium',
        // ì›ê²© ë¸Œë¼ìš°ì € ì—”ë“œí¬ì¸íŠ¸
        connectOptions: {
          wsEndpoint: process.env.REMOTE_BROWSER_WS
        }
      }
    }
  ]
});
```

## ğŸ“¡ í†µì‹  í”„ë¡œí† ì½œ

### 1. **ë¸Œë¼ìš°ì € ì œì–´ ëª…ë ¹**
```json
{
  "type": "browser_command",
  "action": "launch",
  "options": {
    "headless": true,
    "args": ["--no-sandbox", "--disable-web-security"]
  }
}
```

### 2. **í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìš”ì²­**
```json
{
  "type": "test_execution",
  "testFile": "windwalker-phase1.spec.js",
  "config": {
    "baseURL": "http://firebase-studio:8082",
    "timeout": 60000
  }
}
```

### 3. **ê²°ê³¼ ë°˜í™˜**
```json
{
  "type": "test_result",
  "status": "passed|failed",
  "results": [...],
  "screenshots": ["base64..."],
  "trace": "..."
}
```

## ğŸš€ ë°°í¬ ë°©ë²•

### A. **í´ë¼ìš°ë“œ ì¸ìŠ¤í„´ìŠ¤** 
- **Google Cloud Run**: ì„œë²„ë¦¬ìŠ¤, ìë™ ìŠ¤ì¼€ì¼ë§
- **AWS ECS**: ì»¨í…Œì´ë„ˆ ê¸°ë°˜, ì•ˆì •ì  
- **Digital Ocean Droplet**: ë‹¨ìˆœ, ì €ë ´

### B. **ë¡œì»¬ Docker**
```bash
# ì›ê²© ë¸Œë¼ìš°ì € ì„œë²„ ì‹¤í–‰
docker run -d -p 8090:8090 -p 9222:9222 \
  --name remote-browser \
  windwalker/remote-browser-server

# Firebaseì—ì„œ ì—°ê²°
export REMOTE_BROWSER_WS="ws://localhost:8090/browser"
npm run test
```

## ğŸ’¡ ì¥ì 

1. **ì™„ì „í•œ í˜¸í™˜ì„±**: í‘œì¤€ Ubuntu í™˜ê²½ì—ì„œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ê°€ëŠ¥
2. **í™•ì¥ì„±**: ì—¬ëŸ¬ ë¸Œë¼ìš°ì € íƒ€ì… ì§€ì› (Chrome, Firefox, Safari)
3. **ì¬ì‚¬ìš©ì„±**: ë‹¤ë¥¸ ì œì•½ í™˜ê²½ì—ì„œë„ í™œìš© ê°€ëŠ¥
4. **ë…ë¦½ì„±**: Firebase í™˜ê²½ ë³€ê²½ ì—†ì´ ë¸Œë¼ìš°ì € ì—…ê·¸ë ˆì´ë“œ ê°€ëŠ¥

## âš ï¸ ê³ ë ¤ì‚¬í•­

1. **ë„¤íŠ¸ì›Œí¬ ì§€ì—°**: ì›ê²© í†µì‹ ìœ¼ë¡œ ì¸í•œ í…ŒìŠ¤íŠ¸ ì†ë„ ì €í•˜
2. **ë³´ì•ˆ**: ë¸Œë¼ìš°ì € ì„œë²„ ì ‘ê·¼ ê¶Œí•œ ê´€ë¦¬
3. **ë¹„ìš©**: ë³„ë„ ì„œë²„ ì¸ìŠ¤í„´ìŠ¤ ìš´ì˜ ë¹„ìš©
4. **ë³µì¡ì„±**: ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ ì¦ê°€

## ğŸ¯ êµ¬í˜„ ìš°ì„ ìˆœìœ„

1. **1ë‹¨ê³„**: ë¡œì»¬ Docker ê¸°ë°˜ í”„ë¡œí† íƒ€ì… êµ¬ì¶• 
2. **2ë‹¨ê³„**: WebSocket ê¸°ë°˜ í†µì‹  í”„ë¡œí† ì½œ êµ¬í˜„
3. **3ë‹¨ê³„**: Playwright ì›ê²© ì—°ê²° í†µí•©
4. **4ë‹¨ê³„**: í´ë¼ìš°ë“œ ë°°í¬ ë° ìš´ì˜ í™˜ê²½ êµ¬ì¶•
5. **5ë‹¨ê³„**: í…ŒìŠ¤íŠ¸ ìë™í™” ë£¨í”„ í†µí•© ë° ìµœì í™”