# WindWalker AI ëŒ€í™”ì‹ ì›¹ì‚¬ì´íŠ¸ ë¹Œë” í†µí•© ì„¤ê³„

## ğŸ—ï¸ í†µí•© ì•„í‚¤í…ì²˜ ê°œìš”

### ê¸°ì¡´ ì¤‘ì•™ í—ˆë¸Œ(MessageBridge) í™•ì¥ ë°©ì‹
ê¸°ì¡´ MessageBridgeë¥¼ **AI Workflow Engine**ìœ¼ë¡œ í™•ì¥í•˜ì—¬ AI ëŒ€í™”ì‹ ë¹Œë” ê¸°ëŠ¥ì„ í†µí•©í•©ë‹ˆë‹¤.

```
AI ì±„íŒ… WebView â†’ MessageBridge â†’ AI Workflow Router â†’ ê° ì„œë¹„ìŠ¤
```

## ğŸ“‹ í†µí•© ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

### 1. AI Workflow Router (ìƒˆë¡œ ì¶”ê°€)
```typescript
interface AIWorkflowRouter {
  // ì›Œí¬í”Œë¡œìš° íƒ€ì… ë¼ìš°íŒ…
  routeWorkflow(message: WorkflowMessage): Promise<WorkflowResponse>
  
  // í…œí”Œë¦¿ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°
  handleTemplateWorkflow(request: TemplateWorkflowRequest): Promise<void>
  
  // ììœ  ìƒì„± ì›Œí¬í”Œë¡œìš°  
  handleFreeformWorkflow(request: FreeformWorkflowRequest): Promise<void>
  
  // ìˆ˜ì •/ê°œì„  ì›Œí¬í”Œë¡œìš°
  handleRefinementWorkflow(request: RefinementWorkflowRequest): Promise<void>
}
```

### 2. Template Manager (ìƒˆë¡œ ì¶”ê°€)
```typescript
interface TemplateManager {
  // í…œí”Œë¦¿ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬
  getTemplateCategories(): TemplateCategory[]
  
  // í…œí”Œë¦¿ ê²€ìƒ‰ ë° í•„í„°ë§
  searchTemplates(query: string, filters: TemplateFilter[]): Template[]
  
  // í…œí”Œë¦¿ ë©”íƒ€ë°ì´í„° ê´€ë¦¬
  getTemplateMetadata(templateId: string): TemplateMetadata
  
  // ì‚¬ìš©ì ë§ì¶¤ í…œí”Œë¦¿ ì¶”ì²œ
  recommendTemplates(userProfile: UserProfile): Template[]
}
```

### 3. AI Context Manager (ìƒˆë¡œ ì¶”ê°€)
```typescript
interface AIContextManager {
  // ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬
  maintainConversationContext(sessionId: string): ConversationContext
  
  // ì‚¬ìš©ì ì„ í˜¸ë„ í•™ìŠµ
  learnUserPreferences(userId: string, feedback: UserFeedback): void
  
  // í”„ë¡œì íŠ¸ íˆìŠ¤í† ë¦¬ ê´€ë¦¬
  trackProjectHistory(projectId: string): ProjectHistory
  
  // ì œì•½ ì¡°ê±´ ê´€ë¦¬
  manageConstraints(constraints: DesignConstraints): void
}
```

## ğŸ”„ í†µí•©ëœ ë©”ì‹œì§€ í”Œë¡œìš°

### ê¸°ì¡´ MessageBridge í™•ì¥
```typescript
// ê¸°ì¡´ ë©”ì‹œì§€ íƒ€ì… í™•ì¥
interface ExtendedMessage extends Message {
  workflowType?: 'template' | 'freeform' | 'refinement' | 'comparison'
  templateId?: string
  conversationContext?: ConversationContext
  designConstraints?: DesignConstraints
}

// MessageBridge í™•ì¥
class EnhancedMessageBridge extends MessageBridge {
  private aiWorkflowRouter: AIWorkflowRouter
  private templateManager: TemplateManager
  private aiContextManager: AIContextManager
  
  async handleMessage(message: ExtendedMessage): Promise<void> {
    // ê¸°ì¡´ ë©”ì‹œì§€ ì²˜ë¦¬ ë¡œì§ ìœ ì§€
    if (message.workflowType) {
      // AI ì›Œí¬í”Œë¡œìš° ë©”ì‹œì§€ ì²˜ë¦¬
      await this.aiWorkflowRouter.routeWorkflow(message)
    } else {
      // ê¸°ì¡´ ë©”ì‹œì§€ ì²˜ë¦¬
      await super.handleMessage(message)
    }
  }
}
```

## ğŸ¯ ì£¼ìš” ì›Œí¬í”Œë¡œìš° í†µí•© ì‹œë‚˜ë¦¬ì˜¤

### 1. í…œí”Œë¦¿ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°
```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant ChatUI as AI ì±„íŒ… WebView
    participant MB as MessageBridge
    participant TM as TemplateManager
    participant BM as BuildManager
    participant PV as í”„ë¦¬ë·° WebView

    User->>ChatUI: "ì‡¼í•‘ëª° ì‚¬ì´íŠ¸ ë§Œë“¤ì–´ì¤˜"
    ChatUI->>MB: postMessage({type: 'template:search', query: 'ì‡¼í•‘ëª°'})
    MB->>TM: searchTemplates('ì‡¼í•‘ëª°')
    TM-->>MB: ì¶”ì²œ í…œí”Œë¦¿ ë¦¬ìŠ¤íŠ¸
    MB-->>ChatUI: í…œí”Œë¦¿ ì„ íƒ UI í‘œì‹œ
    User->>ChatUI: í…œí”Œë¦¿ ì„ íƒ
    ChatUI->>MB: postMessage({type: 'template:apply', templateId: 'shop-001'})
    MB->>BM: applyTemplate('shop-001')
    BM->>PV: ì´ˆê¸° í”„ë¦¬ë·° ìƒì„±
    PV-->>ChatUI: í”„ë¦¬ë·° ì™„ë£Œ ì•Œë¦¼
```

### 2. AI ê°œì„  ì›Œí¬í”Œë¡œìš°
```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant ChatUI as AI ì±„íŒ… WebView
    participant MB as MessageBridge
    participant AI as AI Context Manager
    participant CG as CodeGeneration Service
    participant BM as BuildManager
    participant PV as í”„ë¦¬ë·° WebView

    User->>ChatUI: "í—¤ë”ë¥¼ ë” ëª¨ë˜í•˜ê²Œ ë°”ê¿”ì¤˜"
    ChatUI->>MB: postMessage({type: 'refinement:request', target: 'header', style: 'modern'})
    MB->>AI: analyzeRefinementRequest()
    AI->>CG: generateRefinementOptions()
    CG-->>AI: 3ê°€ì§€ ê°•ë„ë³„ ì˜µì…˜
    AI-->>MB: ì˜µì…˜ + ì„¤ëª…
    MB-->>ChatUI: ì˜µì…˜ ë¹„êµ UI í‘œì‹œ
    User->>ChatUI: ì˜µì…˜ ì„ íƒ
    ChatUI->>MB: postMessage({type: 'refinement:apply', optionId: 'modern-v2'})
    MB->>BM: applyRefinement()
    BM->>PV: ì—…ë°ì´íŠ¸ëœ í”„ë¦¬ë·°
```

## ğŸ”§ ê¸°ì¡´ ì„œë¹„ìŠ¤ì™€ì˜ ì—°ë™ì 

### 1. FileManager ì—°ë™
- **í…œí”Œë¦¿ íŒŒì¼ ê´€ë¦¬**: í…œí”Œë¦¿ HTML/CSS/JS íŒŒì¼ ì €ì¥ ë° ë²„ì „ ê´€ë¦¬
- **ìƒì„± íŒŒì¼ ê´€ë¦¬**: AIê°€ ìƒì„±í•œ ì½”ë“œ íŒŒì¼ë“¤ì˜ ì‹¤ì‹œê°„ ë™ê¸°í™”
- **í”„ë¡œì íŠ¸ êµ¬ì¡° ê´€ë¦¬**: ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë‚´ í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡° ìë™ ìƒì„±

### 2. BuildManager ì—°ë™
- **ì‹¤ì‹œê°„ ë¹Œë“œ**: ê° AI ìˆ˜ì •ì‚¬í•­ì„ ì¦‰ì‹œ ë¹Œë“œí•˜ì—¬ í”„ë¦¬ë·° ì œê³µ
- **ì ì§„ì  ë¹Œë“œ**: ë³€ê²½ëœ ë¶€ë¶„ë§Œ ì„ íƒì ìœ¼ë¡œ ë¹Œë“œí•˜ì—¬ ì„±ëŠ¥ ìµœì í™”
- **ë¹Œë“œ íˆìŠ¤í† ë¦¬**: ê° ëŒ€í™” ë‹¨ê³„ë³„ ë¹Œë“œ ê²°ê³¼ ì €ì¥ ë° ë¡¤ë°± ê°€ëŠ¥

### 3. CodeGenerationService ì—°ë™
- **ì œì•½ ê¸°ë°˜ ìƒì„±**: í…œí”Œë¦¿ê³¼ ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ì„ ë°”íƒ•ìœ¼ë¡œ í•œ ì œí•œì  ì½”ë“œ ìƒì„±
- **ì ì§„ì  ê°œì„ **: ê¸°ì¡´ ì½”ë“œ ê¸°ë°˜ ë¶€ë¶„ ìˆ˜ì • ë° ê°œì„ 
- **ë‹¤ì¤‘ ì˜µì…˜ ìƒì„±**: í•˜ë‚˜ì˜ ìš”ì²­ì— ëŒ€í•´ ì—¬ëŸ¬ êµ¬í˜„ ì˜µì…˜ ì œê³µ

## ğŸ“Š ìƒíƒœ ê´€ë¦¬ í†µí•©

### 1. ëŒ€í™” ìƒíƒœ ê´€ë¦¬
```typescript
interface ConversationState {
  sessionId: string
  currentTemplate: Template | null
  projectHistory: ProjectStep[]
  userPreferences: UserPreferences
  activeConstraints: DesignConstraints
  conversationContext: string[]
}
```

### 2. í”„ë¡œì íŠ¸ ìƒíƒœ ê´€ë¦¬
```typescript
interface ProjectState {
  projectId: string
  templateBase: Template
  currentCode: ProjectFiles
  buildStatus: BuildStatus
  previewUrl: string
  changeHistory: ChangeEvent[]
}
```

## ğŸš€ êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ê¸°ë³¸ í†µí•© (2-3ì£¼)
1. MessageBridgeì— AI ì›Œí¬í”Œë¡œìš° ë¼ìš°í„° ì¶”ê°€
2. ê¸°ë³¸ í…œí”Œë¦¿ ë§¤ë‹ˆì € êµ¬í˜„
3. ê°„ë‹¨í•œ í…œí”Œë¦¿ ì ìš© ì›Œí¬í”Œë¡œìš° êµ¬í˜„

### Phase 2: AI ê¸°ëŠ¥ ê°•í™” (3-4ì£¼)
1. AI Context Manager êµ¬í˜„
2. ì ì§„ì  ê°œì„  ì›Œí¬í”Œë¡œìš° êµ¬í˜„
3. ë‹¤ì¤‘ ì˜µì…˜ ë¹„êµ ì‹œìŠ¤í…œ êµ¬í˜„

### Phase 3: ê³ ê¸‰ ê¸°ëŠ¥ (4-5ì£¼)
1. ì‚¬ìš©ì í•™ìŠµ ì‹œìŠ¤í…œ êµ¬í˜„
2. ì œì•½ ì¡°ê±´ ì—”ì§„ êµ¬í˜„
3. ì„±ëŠ¥ ìµœì í™” ë° ìºì‹± ì‹œìŠ¤í…œ

## ğŸ”„ í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### 1. ëª¨ë“ˆí™” ì„¤ê³„
- ê° AI ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ê°œë°œ ë° ë°°í¬ ê°€ëŠ¥
- í”ŒëŸ¬ê·¸ì¸ ë°©ì‹ìœ¼ë¡œ ìƒˆë¡œìš´ ì›Œí¬í”Œë¡œìš° íƒ€ì… ì¶”ê°€ ê°€ëŠ¥

### 2. ìŠ¤ì¼€ì¼ë§ ê³ ë ¤
- AI ì„œë¹„ìŠ¤ í˜¸ì¶œ ìµœì í™” (ë°°ì¹˜ ì²˜ë¦¬, ìºì‹±)
- ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ ì••ì¶• ë° íš¨ìœ¨ì  ì €ì¥
- ì‹¤ì‹œê°„ í”„ë¦¬ë·° ì„±ëŠ¥ ìµœì í™”

### 3. í˜¸í™˜ì„± ìœ ì§€
- ê¸°ì¡´ í”„ë¦¬ë·° WebViewì™€ì˜ ì™„ì „í•œ í˜¸í™˜ì„± ë³´ì¥
- ê¸°ì¡´ íŒŒì¼ ê´€ë¦¬ ì‹œìŠ¤í…œê³¼ì˜ seamless ì—°ë™
- í–¥í›„ ì¶”ê°€ë  AI ëª¨ë¸ê³¼ì˜ í™•ì¥ ê°€ëŠ¥í•œ ì¸í„°í˜ì´ìŠ¤



## ğŸ”„ ì£¼ìš” í†µí•© ì „ëµ
1. ë¹„ì¹¨í•´ì  í™•ì¥

ê¸°ì¡´ MessageBridgeë¥¼ ìƒì†/í™•ì¥í•˜ì—¬ AI ì›Œí¬í”Œë¡œìš° ê¸°ëŠ¥ ì¶”ê°€
ê¸°ì¡´ ì„œë¹„ìŠ¤ë“¤(FileManager, BuildManager, CodeGeneration)ê³¼ì˜ í˜¸í™˜ì„± 100% ìœ ì§€
ìƒˆë¡œìš´ ë©”ì‹œì§€ íƒ€ì… ì¶”ê°€ë¡œ AI ê¸°ëŠ¥ê³¼ ê¸°ì¡´ ê¸°ëŠ¥ êµ¬ë¶„

2. ì ì§„ì  í†µí•©

Phaseë³„ êµ¬í˜„ìœ¼ë¡œ ë¦¬ìŠ¤í¬ ìµœì†Œí™”
ê° ë‹¨ê³„ì—ì„œ ê¸°ì¡´ ê¸°ëŠ¥ ì˜í–¥ ì—†ì´ ìƒˆ ê¸°ëŠ¥ ì¶”ê°€
ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜ ì ì§„ì  ê°œì„ 

3. ìƒíƒœ ê´€ë¦¬ í†µí•©

ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ì™€ í”„ë¡œì íŠ¸ ìƒíƒœì˜ ë¶„ë¦¬ëœ ê´€ë¦¬
ê¸°ì¡´ íŒŒì¼ ì‹œìŠ¤í…œê³¼ ì—°ë™ëœ í”„ë¡œì íŠ¸ íˆìŠ¤í† ë¦¬
ì‹¤ì‹œê°„ ë™ê¸°í™”ë¡œ ì¼ê´€ì„± ë³´ì¥

ì´ ì„¤ê³„ë¡œ WindWalkerëŠ” **"í…œí”Œë¦¿ ê¸°ë°˜ì˜ ì•ˆì •ì„± + AIì˜ ë¬´í•œí•œ ê°€ëŠ¥ì„±"**ì„ ì œê³µí•˜ëŠ” ì°¨ë³„í™”ëœ ì›¹ì‚¬ì´íŠ¸ ë¹Œë”ê°€ ë  ê²ƒì…ë‹ˆë‹¤.