# WindWalker Proxmox 상용 서비스 구축 계획서

## 📊 1. 실 가용 동접자 수 분석

### 💡 동접자 수 산정 기준
WindWalker 서비스 특성을 기반으로 한 동접자 수 예측:

#### **A. WindWalker 서비스별 리소스 요구사항**
- **Code Server**: CPU 1~2코어, RAM 2~4GB (사용자당)
- **LLM 서비스**: CPU 4~8코어, RAM 8~16GB (공유)
- **브라우저 테스트 서버**: CPU 2~4코어, RAM 4~8GB (공유)
- **배포/프리뷰 서버**: CPU 1~2코어, RAM 1~2GB (프로젝트당)

#### **B. 동접자 수별 시나리오**

| 동접자 수 | 코드 편집 | LLM 사용 | 테스트 실행 | 필요 리소스 (CPU/RAM) |
|-----------|-----------|----------|-------------|----------------------|
| **10명** | 8명 | 3명 | 2명 | 24코어 / 64GB |
| **50명** | 40명 | 15명 | 8명 | 96코어 / 256GB |
| **100명** | 80명 | 30명 | 15명 | 180코어 / 480GB |
| **500명** | 400명 | 100명 | 50명 | 800코어 / 2TB |

#### **C. 현실적 동접자 수 한계**
```
추천 구성별 최대 동접자 수:
├── 기본형 (1서버): 10~20명
├── 표준형 (3서버): 50~80명  
├── 확장형 (5서버): 100~150명
└── 엔터프라이즈 (10서버+): 300~500명+
```

## 🖥️ 2. 구축 PC 사양 컨설팅

### **A. 기본형 서버 (10~20 동접)**
```
CPU: AMD Ryzen 9 7950X (16코어/32스레드) 또는 Intel i9-13900K
RAM: 128GB DDR5 (4x32GB) - ECC 권장
스토리지: 
  - OS: NVMe SSD 1TB (Samsung 990 Pro)
  - VM Storage: NVMe SSD 4TB x2 (RAID 1)
  - Backup: HDD 8TB x2 (RAID 1)
네트워크: 2.5Gb NIC x2 (본딩 구성)
예상 비용: 700~900만원
```

### **B. 표준형 클러스터 (50~80 동접)**
```
노드 1-3: 각각
CPU: AMD EPYC 7413 (24코어/48스레드) 또는 Intel Xeon Silver 4314
RAM: 256GB DDR4 ECC (8x32GB)
스토리지:
  - OS: NVMe SSD 1TB
  - Ceph OSD: NVMe SSD 8TB x4
  - Cold Storage: HDD 16TB x4
네트워크: 10Gb NIC x2 + 1Gb NIC x2
노드당 비용: 1,500~2,000만원
총 비용: 4,500~6,000만원
```

### **C. 확장형 클러스터 (100~150 동접)**
```
노드 1-5: 각각
CPU: AMD EPYC 7543 (32코어/64스레드)
RAM: 512GB DDR4 ECC (16x32GB)
스토리지: Ceph 분산 스토리지
  - NVMe SSD 16TB x6 (Hot data)
  - SATA SSD 32TB x4 (Warm data)  
  - HDD 64TB x8 (Cold backup)
네트워크: 25Gb NIC x2 (본딩) + 10Gb NIC x2
노드당 비용: 3,000~4,000만원
총 비용: 1.5~2억원
```

### **D. RAID 및 DB 스토리지 전략**
```
레이어별 스토리지 구성:
├── Tier 1 (Hot): NVMe RAID 10 - 활성 VM/DB
├── Tier 2 (Warm): SATA SSD RAID 5 - 백업/아카이브
├── Tier 3 (Cold): HDD RAID 6 - 장기 백업
└── Ceph 분산: 3중 복제 + 이레이저 코딩
```

## 🔄 3. 무중단 클라우드 구축 설정 (Proxmox 중심)

### **A. 고가용성 클러스터 구성**
```bash
# 1단계: Proxmox VE 8.3 클러스터 생성
pvecm create windwalker-cluster

# 2단계: 추가 노드 조인
pvecm add <first-node-ip>

# 3단계: Ceph 분산 스토리지 구성
ceph osd create-pool vm-storage 128 128
ceph osd create-pool ct-storage 64 64
```

### **B. 네트워크 이중화 설정**
```bash
# 본딩 구성 (active-backup)
auto bond0
iface bond0 inet static
    address 192.168.1.100/24
    gateway 192.168.1.1
    bond-slaves ens3 ens4
    bond-mode active-backup
    bond-miimon 100
```

### **C. 자동 페일오버 구성**
```yaml
# HA 그룹 생성
ha-manager groupadd windwalker-prod --nodes node1,node2,node3

# 중요 VM을 HA 그룹에 추가  
ha-manager add vm:101 --group windwalker-prod --max_restart 3
```

### **D. 백업 및 복구 전략**
```bash
# 자동 백업 스케줄
vzdump --mode snapshot --compress gzip --storage backup-storage --all 1

# 복제 설정 (DR 사이트)
pvesr create-local-job 101 node2 --schedule "*/15"
```

## 💰 4. 상용 클라우드 전환 시기 산정

### **A. 비용 분석 (월간 기준)**

#### **자체 구축 비용**
```
초기 투자: 
├── 기본형: 800만원 (3년 상각 시 월 22만원)
├── 표준형: 5,000만원 (3년 상각 시 월 139만원)
└── 확장형: 1.8억원 (3년 상각 시 월 500만원)

운영 비용 (월간):
├── 전력비: 50~200만원 (구성에 따라)
├── 회선비: 30~100만원 (전용선 기준)  
├── 관리비: 100~300만원 (인건비)
└── 총 월간 비용: 200~750만원
```

#### **퍼블릭 클라우드 비용 (AWS/Azure 기준)**
```
동접자별 월간 비용:
├── 50명: 800~1,200만원/월
├── 100명: 1,800~2,500만원/월
├── 300명: 5,000~7,000만원/월
└── 500명: 8,000~12,000만원/월
```

### **B. 전환 시점 분석**

| 동접자 수 | 자체 구축 비용 | 클라우드 비용 | 권장사항 |
|-----------|----------------|---------------|----------|
| **~30명** | 월 200만원 | 월 500만원 | ✅ **자체 구축** |
| **30~80명** | 월 400만원 | 월 1,200만원 | ✅ **자체 구축** |
| **80~150명** | 월 600만원 | 월 2,500만원 | ✅ **자체 구축** |
| **150~300명** | 월 750만원 | 월 5,000만원 | ✅ **자체 구축** |
| **300명+** | 월 1,000만원+ | 월 7,000만원+ | 🤔 **비교 검토** |

### **C. 전환 고려 요소**

#### **자체 구축 유지 조건**
- ✅ 동접자 300명 이하
- ✅ 기술 관리 역량 보유
- ✅ 안정적인 전력/회선 환경
- ✅ 컴플라이언스 요구사항 충족

#### **클라우드 전환 고려 시점**
- ⚠️ 동접자 500명 이상 지속
- ⚠️ 글로벌 서비스 확장 필요
- ⚠️ 관리 인력 부족
- ⚠️ 컴플라이언스 복잡성 증가

## 🎯 추천 로드맵

### **Phase 1: 검증 단계 (0~3개월)**
```
목표: WindWalker 서비스 안정성 검증
구성: 기본형 1서버 (동접 10~20명)
투자: 800만원
```

### **Phase 2: 확장 단계 (3~12개월)**  
```
목표: 사용자 증가에 따른 확장
구성: 표준형 3서버 클러스터 (동접 50~80명)
투자: 추가 4,200만원
```

### **Phase 3: 성숙 단계 (12~24개월)**
```
목표: 안정적인 상용 서비스 운영
구성: 확장형 5서버 클러스터 (동접 100~150명)  
투자: 추가 1.3억원
```

### **Phase 4: 스케일링 판단 (24개월+)**
```
목표: 대규모 확장 또는 클라우드 전환 결정
기준: 동접자 300명+ 지속 시 전환 검토
```

## 📋 결론

**WindWalker 서비스**의 경우 **동접자 300명 이하**에서는 **자체 Proxmox 구축**이 **60~80% 비용 절감** 효과를 보이며, 기술적 통제권과 보안성도 확보할 수 있습니다.

**핵심 성공 요소**:
1. **단계적 확장**: 사용자 증가에 맞춘 점진적 투자
2. **기술 역량**: Proxmox/Docker 관리 전문성 확보  
3. **모니터링**: 성능/비용 지속적 추적
4. **백업 계획**: 클라우드 전환 시나리오 상시 준비

이 계획을 통해 초기 투자를 최소화하면서도 확장 가능한 인프라를 구축할 수 있습니다! 🚀